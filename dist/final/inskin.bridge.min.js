!function(a,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Inskin",[],t):"object"==typeof exports?exports.Inskin=t():a.Inskin=t()}("undefined"!=typeof self?self:this,function(){return function(a){function t(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return a[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var e={};return t.m=a,t.c=e,t.d=function(a,e,o){t.o(a,e)||Object.defineProperty(a,e,{configurable:!1,enumerable:!0,get:o})},t.n=function(a){var e=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(e,"a",e),e},t.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},t.p="",t(t.s="./src/index.js")}({"./src/button/create.js":function(a,t,e){"use strict";function o(){this.layers=[],this.stylesheets=[],this.creativeId="",this.device="Desktop",$||console.log("The jQuery is not available.");var a={frameId:""};arguments[0]&&"object"===y(arguments[0])&&(this.options=c(a,arguments[0]));var t=this,e=i(window.parent.parent)?window.parent.parent:window.parent;e.addEventListener("message",function(a){var e=Array.from(document.styleSheets).filter(function(a){return a&&a.href&&a.href.includes("/proxy/")}),o=Array.from(document.styleSheets).filter(function(a){return a&&a.href&&a.href.includes("/gateway/")}),r=[].concat(e||[]).concat(o||[]),d=JSON.parse(a.data);switch(d.method){case"areYouReady":var l=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0],c={method:"onAreYouReady",data:{frameId:l}};"undefined"!=typeof areYouReady&&areYouReady&&window.top.postMessage(JSON.stringify(c),"*");break;case"setupId":t.creativeId=d.payload.creativeId,t.device=d.payload.device;break;case"initLayers":t.initAllLayers(),t.stylesheets=t.initAllStysheets(),$("html > head").append($("<style>div[data-ism-layer] {border:1px dashed;box-sizing:border-box;}</style>"));break;case"getLayers":t.layers=t.getAllLayers(),t.stylesheets=t.initAllStysheets();var u={method:"onGetLayers",data:t.layers};window.top.postMessage(JSON.stringify(u),"*");break;case"applyActionToLayer":if("bgtype"===d.payload.action){$("#"+d.payload.id).attr("data-bgtype",d.payload.value);var y=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0],f={};f["#"+d.payload.id]=["data-bgtype",d.payload.value],n(t.creativeId,y,[f]),g()}if("align"===d.payload.action){var v=$("#"+d.payload.id),h=v.prop("tagName");r.map(function(a){switch(d.payload.value){case"left":"video"===d.payload.variant&&p(a,"#"+d.payload.id,[["left","0px"]],["right","margin-left"])?s(t.creativeId,a):"DIV"===h&&p(a,"#"+d.payload.id,[["background-position-x","left"]],[])&&s(t.creativeId,a);break;case"center":var e=parseInt(v.css("width"));"video"===d.payload.variant&&p(a,"#"+d.payload.id,[["left","50%"],["margin-left","-"+e/2+"px"]],["right"])?s(t.creativeId,a):"DIV"===h&&p(a,"#"+d.payload.id,[["background-position-x","center"]],[])&&s(t.creativeId,a);break;case"right":"video"===d.payload.variant&&p(a,"#"+d.payload.id,[["right","0"]],["left","margin-left"])?s(t.creativeId,a):"DIV"===h&&p(a,"#"+d.payload.id,[["background-position-x","right"]],[])&&s(t.creativeId,a);break;case"top":"video"===d.payload.variant&&p(a,"#"+d.payload.id,[["top","0"]],["bottom","margin-top"])?s(t.creativeId,a):"DIV"===h&&p(a,"#"+d.payload.id,[["background-position-y","top"]],[])&&s(t.creativeId,a);break;case"middle":var o=parseInt(v.css("height"));"video"===d.payload.variant&&p(a,"#"+d.payload.id,[["top","50%"],["margin-top","-"+o/2+"px"]],["bottom"])?s(t.creativeId,a):"DIV"===h&&p(a,"#"+d.payload.id,[["background-position-y","center"]],[])&&s(t.creativeId,a);break;case"bottom":"video"===d.payload.variant&&p(a,"#"+d.payload.id,[["bottom","0"]],["top","margin-top"])?s(t.creativeId,a):"DIV"===h&&p(a,"#"+d.payload.id,[["background-position-y","bottom"]],[])&&s(t.creativeId,a)}})}if("background-position-x"===d.payload.action||"background-position-y"===d.payload.action||"background-position"===d.payload.action||"z-index"===d.payload.action||"width"===d.payload.action||"height"===d.payload.action||"top"===d.payload.action||"left"===d.payload.action||"right"===d.payload.action||"bottom"===d.payload.action){r.filter(function(a){return a.href.includes(d.payload.group+".css")}).map(function(a){p(a,"#"+d.payload.id,[[d.payload.action,d.payload.value]])&&s(t.creativeId,a)});var b=$("#"+d.payload.id),w=b.attr("data-ism-links")&&b.attr("data-ism-links").split(","),I=(w||[]).map(function(a){return a.trim()});r.map(function(a){p(a,"#"+d.payload.id,[[d.payload.action,d.payload.value]])&&s(t.creativeId,a)}),I.length&&I.map(function(a){var t={method:"applyActionToLayer",payload:{id:a,variant:d.payload.variant,action:d.payload.action,value:d.payload.value}};m(t)})}if("background-color"===d.payload.action){var k=$("#"+d.payload.id),x=(k.prop("tagName"),k.attr("data-ism-links")&&k.attr("data-ism-links").split(",")),S=(x||[]).map(function(a){return a.trim()});r.map(function(a){p(a,"#"+d.payload.id,[["background-color",d.payload.value]])&&s(t.creativeId,a),"header-bg"===d.payload.id&&p(a,"body",[["background-color",d.payload.value]])&&s(t.creativeId,a)}),S.length&&S.map(function(a){var t={method:"applyActionToLayer",payload:{id:a,variant:d.payload.variant,action:d.payload.action,value:d.payload.value}};m(t)})}if("image"===d.payload.action){var L=$("#"+d.payload.id),A=L.prop("tagName"),O=L.attr("data-ism-links")&&L.attr("data-ism-links").split(","),R=(O||[]).map(function(a){return a.trim()});if("DIV"===A){t.creativeId;d.payload.value=d.payload.value.replace("https://creator.inskinmedia.com/gateway/assets/creatives/"+t.creativeId+"/build/assets","./assets"),d.payload.value=d.payload.value.replace("http://localhost:4000/gateway/assets/creatives/"+t.creativeId+"/build/assets","./assets"),r.map(function(a){if(d.payload.value){var e=[["background-image","url("+d.payload.value+")"]];"Smartphone"===t.device&&e.push(["background-size",parseInt(d.payload.asset.raw_width,10)/2+"px auto"]),p(a,"#"+d.payload.id,e)&&s(t.creativeId,a)}else p(a,"#"+d.payload.id,[["background-image",""],["background-size",""]])&&s(t.creativeId,a)}),R.length&&R.map(function(a){var t={method:"applyActionToLayer",payload:{id:a,variant:d.payload.variant,action:d.payload.action,value:d.payload.value,asset:d.payload.asset}};m(t)})}}if("video-poster"===d.payload.action){$("#"+d.payload.id).attr("data-poster",d.payload.value);var T=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0],z={};z["#"+d.payload.id]=["data-poster",d.payload.value],n(t.creativeId,T,[z]);var D=$("#"+d.payload.id+" #poster"),N=D.prop("tagName");if(D&&"IMG"===N){D.attr("src",d.payload.value);var j=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0];n(t.creativeId,j,[{"#poster":["src",d.payload.value]}])}}if("video"===d.payload.action){$("#"+d.payload.id).attr("data-ism-video-url",d.payload.value);var M=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0],P={};P["#"+d.payload.id]=["data-ism-video-url",d.payload.value],n(t.creativeId,M,[P])}if("video-auto-play"===d.payload.action){$("#"+d.payload.id).attr("data-ism-auto-play",d.payload.value);var J=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0],V={};V["#"+d.payload.id]=["data-ism-auto-play",d.payload.value],n(t.creativeId,J,[V]),g()}if("video-allow-fullscreen"===d.payload.action){$("#"+d.payload.id).attr("data-ism-allow-fullscreen",d.payload.value);var Y=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0],E={};E["#"+d.payload.id]=["data-ism-allow-fullscreen",d.payload.value],n(t.creativeId,Y,[E]),g()}if("video-show-controls"===d.payload.action){var F={},_=$("#"+d.payload.id);_.attr("data-ism-show-controls",d.payload.value),"false"===d.payload.value.toString()?(_.attr("data-ism-auto-play","true"),_.attr("data-ism-allow-fullscreen","false"),F["#"+d.payload.id]=[["data-ism-show-controls",d.payload.value],["data-ism-auto-play","true"],["data-ism-allow-fullscreen","false"]]):(_.attr("data-ism-auto-play","true"),_.attr("data-ism-allow-fullscreen","true"),F["#"+d.payload.id]=[["data-ism-show-controls",d.payload.value],["data-ism-auto-play","true"],["data-ism-allow-fullscreen","true"]]);var U=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0];n(t.creativeId,U,[F]),g()}break;case"selectLayer":if(t.layers=t.getAllLayers(),$("[data-ism-layer-active]").each(function(a){$(this).hide()}),d.layer.id){var B=(i(window.parent.parent),window.parent.document),C=t.layers.find(function(a){return a.id===d.layer.id});if(C&&C.hasScroll){var G=$(window).scrollTop();i(window.parent.parent)?$(B).find("body").animate({scrollTop:G+parseInt(C.hasScroll)},600):$(B).find("html").animate({scrollTop:G+parseInt(C.hasScroll)},600)}else $(B).scrollTop(0);C&&C.links,$("#"+d.layer.id).find("[data-ism-layer-active]").show()}break;default:console.log("NOT IDENTIFIED METHOD",d.method)}})}function i(a){try{return a.self!==window.top}catch(a){return!0}}function r(a){return a.replace(/^\s+|\s+$/gm,"")}function d(a){var t=a.substring(a.indexOf("(")).split(","),e=parseInt(r(t[0].substring(1)),10),o=parseInt(r(t[1]),10),i=parseInt(r(t[2]),10),d=t[3]?parseFloat(r(t[3].substring(0,t[3].length-1))).toFixed(2):"";return"#"+e.toString(16)+o.toString(16)+i.toString(16)+(t[3]?(255*d).toString(16).substring(0,2):"")}function n(a,t,e){var o={method:"onPropsUpdate",data:{creativeId:a,file:t,props:e}};window.top.postMessage(JSON.stringify(o),"*")}function s(a,t){var e=t.href.replace(/^.*[\\\/]/,""),o={method:"onCSSUpdate",data:{creativeId:a,file:e,source:l(t)}};window.top.postMessage(JSON.stringify(o),"*")}function l(a){var t=null,e="";void 0!==a.cssRules?t=a.cssRules:void 0!==a.rules&&(t=a.rules);for(var o in t)void 0!=t[o].cssText&&(e+=t[o].cssText+"\n\n");return e}function p(a,t,e,o,i){t=t,o=o||[],e=e||[];var r=!1;if(a&&a.cssRules)for(var d=0;d<a.cssRules.length;d++){var n=a.cssRules[d];if(n.selectorText===t)return o.map(function(a){return n.style.removeProperty(a)}),e.map(function(a){n.style[a[0]]=a[1]}),r=!0,!0}return!!r&&(a.insertRule(t+" { "+property+": "+value+"; }",0),!0)}function c(a,t){var e;for(e in t)t.hasOwnProperty(e)&&(a[e]=t[e]);return a}t.a=o;var u=this,y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};o.getLayers=function(){u.getAllLayers()},o.prototype.Loaded=function(){console.log("Inskin.Bridge.Loaded");var a=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0],t={method:"onAreYouReady",data:{frameId:a}};window.top.postMessage(JSON.stringify(t),"*"),t={method:"onSetup"},window.top.postMessage(JSON.stringify(t),"*")},o.prototype.getAllLayers=function(){var a=$("[data-ism-layer]"),t=[],e=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/;return a.map(function(a,o){var i=$(o);if(i.attr("data-ism-layer")){var r=document.location.href.replace(/^.*[\\\/]/,"").split("?")[0].replace(".html",""),n={group:r,id:i.attr("id"),key:i.attr("data-ism-key"),name:i.attr("data-ism-name")||i.attr("id"),variant:i.attr("data-ism-layer"),assetURL:i.attr("src")||("none"!==i.css("background-image")?i.css("background-image").replace(/.*\s?url\([\'\"]?/,"").replace(/[\'\"]?\).*/,""):"")||i.attr("data-poster")||i.find("#poster").attr("src")||"",assetVideoURL:i.attr("data-ism-video-url")||"",videoAutoPlay:i.attr("data-ism-auto-play")||"",allowFullscreen:i.attr("data-ism-allow-fullscreen")||"",controls:i.attr("data-ism-show-controls")||"",bgtype:i.attr("data-bgtype")||"",isRemovable:"true"===i.attr("data-ism-removable"),isSelectable:!i.attr("data-ism-selectable")||"true"===i.attr("data-ism-selectable"),isPinned:i.attr("data-ism-pinned")&&"true"===i.attr("data-ism-pinned"),isHidden:i.attr("data-ism-hidden")&&"true"===i.attr("data-ism-hidden"),disabledProps:i.attr("data-ism-disabled-props")||"",order:parseInt(i.attr("data-ism-order"))||100+a,hasScroll:i.attr("data-ism-scroll-to"),links:i.attr("data-ism-links"),style:{backgroundColor:"rgba(0, 0, 0, 0)"!==i.css("background-color")?i.css("background-color")&&!e.test(i.css("background-color"))?d(i.css("background-color")):i.css("background-color"):"",backgroundPositionX:i.css("background-position-x")?i.css("background-position-x"):"0px",backgroundPositionY:i.css("background-position-y")?i.css("background-position-y"):"0px",backgroundPosition:i.css("background-position")?i.css("background-position"):"",zIndex:i.css("z-index")?i.css("z-index"):"",top:i.css("top")?i.css("top"):"0px",left:i.css("left")?i.css("left"):"0px",width:(i.attr("data-ism-width")?i.attr("data-ism-width"):"")||(i.css("width")?i.css("width"):"0px"),height:(i.attr("data-ism-height")?i.attr("data-ism-height"):"")||(i.css("height")?i.css("height"):"0px")}};t.push(n)}}),t},o.prototype.initAllStysheets=function(){return document.styleSheets},o.prototype.initAllLayers=function(){var a=$("[data-ism-layer]")||[];a.map(function(a,t){var e=$(t),o="video"===e.attr("data-ism-layer")?19999+a+1:999+a+1;if(e.attr("data-ism-layer")){"auto"===e.css("zIndex")?"video"===e.attr("data-ism-layer")?e.css("z-index",19999+a+10):e.css("z-index",999+a+10):e.css("zIndex")?o=e.css("zIndex"):e.css("z-index",999+a+10),e.find("img").css("zIndex",o+1);var i=$('<div id="clickable-'+e.attr("id")+'" data-ism-layer-active style="position:absolute;z-index:'+o+";top:0px;left:0px;width:"+e.width()+"px;height:"+e.height()+'px"></div>');i.on("click",function(a){a.preventDefault(),a.stopPropagation()}),e.append(i)}}),document.addEventListener("dragover",function(a){a.preventDefault()},!1),document.addEventListener("drop",function(a){a.preventDefault()},!1)};var f=new o({frameId:ISM.initData.id});f.Loaded();var v=setTimeout(function(){f.initAllLayers(),"undefined"!=typeof areYouReady&&areYouReady&&(clearTimeout(v),f.initAllStysheets(),$("html > head").append($("<style>div[data-ism-layer] {border:1px dashed;box-sizing:border-box;}</style>")))},1e3),m=function(a){(i(window.parent.parent)?window.parent.parent:window.parent).postMessage(JSON.stringify(a),"*")},g=function(){var a={method:"applyReload"};window.top.postMessage(JSON.stringify(a),"*")}},"./src/button/index.js":function(a,t,e){"use strict";var o=e("./src/button/create.js");e.d(t,"a",function(){return o.a})},"./src/index.js":function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e("./src/button/index.js");e.d(t,"Bridge",function(){return o.a})}})});
//# sourceMappingURL=inskin.bridge.min.js.map
//# sourceMappingURL=inskin.bridge.min.js.map